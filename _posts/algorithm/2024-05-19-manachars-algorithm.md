---
title: "ë§¤ë‹ˆì»¤ ì•Œê³ ë¦¬ì¦˜(Manachar's Algorithm)"
parent_category:
    - Computer-Science
categories: 
    - Computer-Science
    - Algorithm
tags:
    - algorithm
date: 2024-05-25 01:30:00 +0200
---

# [1] ê°œìš”
**Manachar's ì•Œê³ ë¦¬ì¦˜ì€ ì£¼ì–´ì§„ ë¬¸ìì—´ ë‚´ì—ì„œ ê°€ì¥ ê¸´ Palindrome ë¶€ë¶„ ë¬¸ìì—´ì„ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜**ì´ë‹¤. `Panlindromicí•œ ë¬¸ìì—´` í˜¹ì€ `Palindrome`ì€ ì •ë°©í–¥ìœ¼ë¡œ ì½ë˜ ì—­ë°©í–¥ìœ¼ë¡œ ì½ë˜ ë˜‘ê°™ì€ ë¬¸ìì—´ì„ ì˜ë¯¸í•œë‹¤(e.g. abba, abcba). 

## Palindromeì˜ íŠ¹ì„±
**palindromeì€ ì¤‘ì‹¬ì—ì„œ ì™¼ìª½ê³¼ ì˜¤ë¥¸ìª½ì˜ ë¬¸ì ë°°ì—´ì´ ëŒ€ì¹­ì„ ì´ë£¬ë‹¤ëŠ” íŠ¹ì„±ì´ ìˆë‹¤.** ì¤‘ì‹¬ì´ ì¡´ì¬í•˜ê¸° ìœ„í•´ì„œëŠ” palindromeì˜ ê¸¸ì´ê°€ í™€ìˆ˜ì—¬ì•¼ í•˜ê¸° ë•Œë¬¸ì— Manachar ì•Œê³ ë¦¬ì¦˜ì—ì„œëŠ” ë¬¸ìì—´ì— dummy ë¬¸ìë¥¼ ë¼ì›Œë„£ëŠ” ì „ì²˜ë¦¬ê°€ í•„ìš”í•˜ë‹¤. ì´ ê°„ë‹¨í•œ íŠ¹ì„±ì„ ì´ìš©í•´ì„œ ì¤‘ë³µ ê³„ì‚°ì„ ì¤„ì—¬ ì‹œê°„ ë³µì¡ë„ì—ì„œ ì´ì ì„ ì·¨í•œë‹¤. Brute Forceë¡œëŠ” O(n^2) í˜¹ì€ O(n^3)ì— í’€ë¦¬ëŠ” ë¬¸ì œë¥¼ `O(n)`ì— í•´ê²°í•  ìˆ˜ ìˆë‹¤. ì‹œê°„ ë³µì¡ë„ì— ëŒ€í•´ì„œëŠ” ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ í›„ ì•„ë˜ì—ì„œ ìì„¸íˆ ì´ì•¼ê¸°í•  ì˜ˆì •ì´ë‹¤. 

## Manachar ì•Œê³ ë¦¬ì¦˜ ë™ì‘ ë°©ì‹
ì£¼ì–´ì§„ ë¬¸ìì—´ì´ `xabay`ë¼ê³  í•  ë•Œ, dummy ë¬¸ìë¥¼ ë¼ì›Œë„£ì–´ `#x#a#b#a#y#`ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤. ê° ë¬¸ìë¥¼ ìˆœíšŒí•˜ë©´ì„œ ê·¸ ë¬¸ìë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ í•˜ëŠ” palindromeì˜ ë°˜ì§€ë¦„ì„ ì €ì¥í•œë‹¤. **ë°˜ì§€ë¦„**ì€ palindrome ê¸¸ì´ì˜ ì ˆë°˜ì„ ì˜ë¯¸í•˜ë©° ì¤‘ì‹¬ì—ì„œ palindromeì˜ ë§ˆì§€ë§‰ ë¬¸ìê¹Œì§€ì˜ ê±°ë¦¬ì´ë‹¤. ê²°ê³¼ëŠ” `P[0, 1, 0, 1, 0, 3, 0, 1, 0, 1, 0]`ì´ ëœë‹¤. 

**ì—¬ê¸°ì„œ ì•Œ ìˆ˜ ìˆëŠ” ì **  
1. ê²°ê³¼ ë°°ì—´ Pê°€ ìµœëŒ“ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ëŒ€ì¹­ì„ ì´ë£¬ë‹¤. **ëª¨ë“  ê²½ìš°ì— ëŒ€ì¹­ì„ ì´ë£°ê¹Œ? ê·¸ê±´ ì•„ë‹ˆë‹¤.** ì—¬ëŸ¬ palindromeì´ ê²¹ì³ì ¸ ìˆëŠ” ê²½ìš°ì— PëŠ” ëŒ€ì¹­ì„ ì´ë£¨ì§€ ì•ŠëŠ”ë‹¤. (ì˜ˆ: `#a#b#a#a#b#` -> `P[0, 1, 0, 3, 0, 1, 4, 1, 0, 1, 0]`)
2. P[5]ì—ì„œ 3ìœ¼ë¡œ ìµœëŒ“ê°’ì„ ê°€ì§€ê³ , ì´ëŠ” ì›ë˜ ë¬¸ìì—´ `xabay`ì—ì„œ ìµœëŒ€ palindromeì˜ ê¸¸ì´ê°€ ëœë‹¤. **ì§€ë¦„ì´ ì•„ë‹Œ ë°˜ì§€ë¦„ì„ ì €ì¥í•˜ëŠ” ì´ìœ **ëŠ” ì—¬ê¸°ì— ìˆë‹¤. palindromeì´ ëŒ€ì¹­ì„ ì´ë£¨ê¸° ë•Œë¬¸ì— ì „ì²´ ê¸¸ì´ë¥¼ ì•Œ í•„ìš”ê°€ ì—†ê³ , dummy ë¬¸ìì—´ì„ ë¼ì›Œ ë„£ì–´ ì´ë¯¸ ì‚¬ì´ì¦ˆê°€ 2N+1ë¡œ ì»¤ì¡Œê¸° ë•Œë¬¸ì— ë°˜ì§€ë¦„ ê°’ì€ ì›ë˜ ë¬¸ìì—´ì—ì„œ palindromeì˜ ê¸¸ì´ë¥¼ ë‚˜íƒ€ë‚´ê¸° ë•Œë¬¸ì´ë‹¤.


# [2] Manachar's Algorithm
```
// ë³€ìˆ˜ ì •ì˜
S: ì£¼ì–´ì§„ ë¬¸ìì—´ì— dummy ë¬¸ì `#`ì„ ë¼ì›Œ ë„£ì–´ ìƒˆë¡œ ë§Œë“  ë¬¸ìì—´  
P: ië²ˆì§¸ì—ì„œì˜ palindromeì˜ ë°˜ì§€ë¦„ ê¸¸ì´
(ğŸ”´ë¹¨ê°„ìƒ‰ì€ ìƒˆë¡œ ì½ì€ ê°’, ğŸŸ¢ì´ˆë¡ìƒ‰ì€ ëŒ€ì¹­ì„±ì„ ì´ìš©í•´ ê¸°ì¡´ì˜ ê°’ì„ ê°€ì ¸ì˜¨ ê°’)  
C: í˜„ì¬ ìœ íš¨í•œ palindromeì˜ ì¤‘ì‹¬ ì¸ë±ìŠ¤  
R: í˜„ì¬ ìœ íš¨í•œ palindromeì˜ ë§ˆì§€ë§‰ ì¸ë±ìŠ¤  
```
## ì´ˆê¸°í™”
![Manachar's Algorithm 0]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-0.jpg)
- ì™¼ìª½ ê°’ì´ ì—†ê¸° ë•Œë¬¸ì— palindromeì´ ë  ìˆ˜ ì—†ì–´ í•­ìƒ P[0]=0ì´ë‹¤.
- C=0, R=0

### i=1ì¼ ë•Œ
![Manachar's Algorithm 1]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-1.jpg)
- iê°€ ê¸°ì¡´ì˜ **palindrome ë²”ìœ„(íšŒìƒ‰ ê´„í˜¸)ì„ ë²—ì–´ë‚˜ê¸° ë•Œë¬¸ì—** ìƒˆë¡œ ì—°ì‚°ì„ í•œë‹¤. -> S[2]=S[0]ìœ¼ë¡œ P[1]=1
- í˜„ì¬ì˜ palindromeì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(i=2)ê°€ ê¸°ì¡´ palindromeì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(i=0)ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— ìƒˆë¡œ palindrome ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤. -> C=1, R=2

## i=2ì¼ ë•Œ
![Manachar's Algorithm 2]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-2.jpg)
- iê°€ ê¸°ì¡´ì˜ palindrome ë²”ìœ„(íšŒìƒ‰ ê´„í˜¸)ì•ˆì—ëŠ” ìˆì§€ë§Œ ë²”ìœ„ì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ì— ìœ„ì¹˜í•´ìˆì–´ i=2 ê¸°ì¤€ìœ¼ë¡œ **ì˜¤ë¥¸ìª½ì— ëŒ€í•œ ì •ë³´ê°€ ì•„ì§ ì—†ìœ¼ë¯€ë¡œ** ìƒˆë¡œ ì—°ì‚°ì„ í•´ì•¼í•œë‹¤. -> S[3]=S[1], S[4]=S[0]ìœ¼ë¡œ P[2]=2
- í˜„ì¬ì˜ palindromeì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(i=4)ê°€ ê¸°ì¡´ palindromeì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(i=2)ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— ìƒˆë¡œ palindrome ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•´ì¤€ë‹¤. -> C=2, R=4

## i=3ì¼ ë•Œ
![Manachar's Algorithm 3]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-3.jpg)
- iëŠ” ê¸°ì¡´ì˜ palindrome ë²”ìœ„ ì•ˆì— **ì•ˆì „íˆ** ìœ„ì¹˜í•´ ìˆì–´ ê¸°ì¡´ì˜ ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê¸°ì¡´ palindromeì˜ ì¤‘ì‹¬ Cë¥¼ ê¸°ì¤€ìœ¼ë¡œ P[3]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[1]ì˜ ê°’ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ”ë°, ì´ ë•Œ P[3]=P[1]ì„ ì·¨í–ˆì„ ë•Œ **ì—¬ì „íˆ ê¸°ì¡´ì˜ palindrome ë²”ìœ„ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸í•´ì•¼í•œë‹¤.** ë²”ìœ„ ì•ˆì— ìˆìœ¼ë¯€ë¡œ P[3]=1ì´ ëœë‹¤. ë§Œì•½ ë²”ìœ„ë¥¼ ë²—ì–´ë‚œë‹¤ë©´ ë²—ì–´ë‚˜ì§€ ì•Šì„ ë§Œí¼ë§Œ ì·¨í•´ì•¼í•œë‹¤.
- P[5]!=P[1] ì´ê¸° ë•Œë¬¸ì— ë” ì´ìƒ ì–‘ ì˜†ìœ¼ë¡œ expandí•˜ì§€ ì•ŠëŠ”ë‹¤. 
- palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ê°€ i=4, ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ê°€ i=4ë¡œ ê°™ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤. 

## i=4ì¼ ë•Œ
![Manachar's Algorithm 4]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-4.jpg)
- ë²”ìœ„ ë‚´ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ì´ê¸° ë•Œë¬¸ì— ìƒˆë¡œ ì—°ì‚°ì„ í•œë‹¤. -> P[5]!=P[3]ì´ê¸° ë•Œë¬¸ì— P[4]=0
- palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ê°€ i=4, ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ê°€ i=4ë¡œ ê°™ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤. 

## i=5ì¼ ë•Œ
![Manachar's Algorithm 5]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-5.jpg)
- iê°€ ê¸°ì¡´ì˜ palindrome ë²”ìœ„(íšŒìƒ‰ ê´„í˜¸)ì„ ë²—ì–´ë‚˜ê¸° ë•Œë¬¸ì— ìƒˆë¡œ ì—°ì‚°ì„ í•œë‹¤. -> P[6]=P[4], P[7]=[3], P[8]=P[2]ë¡œ P[5]=3
- í˜„ì¬ì˜ palindromeì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(8)ê°€ ê¸°ì¡´ palindromeì˜ ê°€ì¥ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(4)ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— ìƒˆë¡œ palindrome ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸í•´ì¤€ë‹¤. -> C=5, R=8

## i=6ì¼ ë•Œ
![Manachar's Algorithm 6]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-6.jpg)
- P[6]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[4]ì˜ ê°’ì„ ì·¨í•´ë„ ì—¬ì „íˆ ë²”ìœ„ ì•ˆì— ìˆë‹¤. -> P[6]=P[4]=0
- P[7]!=P[5]ì´ê¸° ë•Œë¬¸ì— ë” ì´ìƒ ì–‘ ì˜†ìœ¼ë¡œ expandí•˜ì§€ ì•ŠëŠ”ë‹¤.
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(6)ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(8)ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## i=7ì¼ ë•Œ
![Manachar's Algorithm 7]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-7.jpg)
- P[7]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[3]=1ì˜ ê°’ì„ ì·¨í•´ë„ ê¸°ì¡´ palindrome(íšŒìƒ‰ ê´„í˜¸)ë¥¼ ë²—ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤. -> ìš°ì„  P[7]=P[3]=1
- P[9]=P[5], P[10]=[4], P[11]=P[3], P[12]=P[2]ì´ë¯€ë¡œ 4ë¥¼ ë”í•´ì¤€ë‹¤. -> P[7]=1+4=5
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(12)ê°€ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(8)ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤. -> C=7, R=12

## i=8ì¼ ë•Œ
![Manachar's Algorithm 8]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-8.jpg)
- P[8]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[6]ì˜ ê°’ì„ ì·¨í•´ë„ ì—¬ì „íˆ ë²”ìœ„ ì•ˆì— ìˆë‹¤. -> P[8]=P[6]=0
- ë²”ìœ„ëŠ” ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## i=9ì¼ ë•Œ
![Manachar's Algorithm 9]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-9.jpg)
- P[9]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[5]ì˜ ê°’ì„ ì·¨í•´ë„ ì—¬ì „íˆ ë²”ìœ„ ì•ˆì— ìˆë‹¤. -> ìš°ì„  P[9]=P[5]=3
- P[13]=P[5], P[14]=[4]ì´ë¯€ë¡œ 2ë¥¼ ë”í•´ì¤€ë‹¤. -> P[9]=3+2=5
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ê°€ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(12)ë³´ë‹¤ í¬ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤. -> C=9, R=14

## i=10ì¼ ë•Œ
![Manachar's Algorithm 10]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-10.jpg)
- P[10]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[8]ì˜ ê°’ì„ ì·¨í•´ë„ ì—¬ì „íˆ ë²”ìœ„ ì•ˆì— ìˆë‹¤. -> P[10]=P[8]=0
- P[11]!=P[9]ì´ê¸° ë•Œë¬¸ì— ë” ì´ìƒ ì–‘ ì˜†ìœ¼ë¡œ expandí•˜ì§€ ì•ŠëŠ”ë‹¤.
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(10)ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## i=11ì¼ ë•Œ
![Manachar's Algorithm 11]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-11.jpg)
- P[11]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[7]ì„ ì·¨í•˜ë©´ ê¸°ì¡´ palindromeì˜ ë²”ìœ„(íŒŒë€ ê´„í˜¸)ë¥¼ ë²—ì–´ë‚œë‹¤. ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•ŠëŠ” í•œë„ ë‚´ì—ì„œ ì„ íƒí•œë‹¤. -> P[11]=3
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(11)ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## i=12ì¼ ë•Œ
![Manachar's Algorithm 12]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-12.jpg)
- P[12]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[6]ì˜ ê°’ì„ ì·¨í•´ë„ ì—¬ì „íˆ ë²”ìœ„ ì•ˆì— ìˆë‹¤. -> P[12]=P[6]=0
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(12)ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## i=13ì¼ ë•Œ
![Manachar's Algorithm 13]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-13.jpg)
- P[13]ì˜ ë¯¸ëŸ¬ë§ ì›ì†Œ P[5]ì„ ì·¨í•˜ë©´ ê¸°ì¡´ palindromeì˜ ë²”ìœ„(íŒŒë€ ê´„í˜¸)ë¥¼ ë²—ì–´ë‚œë‹¤. ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ì§€ ì•ŠëŠ” í•œë„ ë‚´ì—ì„œ ì„ íƒí•œë‹¤. -> P[13]=1
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(13)ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## i=14ì¼ ë•Œ
![Manachar's Algorithm 14]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-14.jpg)
- ë°°ì—´ì˜ ë§ˆì§€ë§‰ ì›ì†Œë¼ì„œ ì˜¤ë¥¸ìª½ì— ëŒ€í•œ ì •ë³´ê°€ ì—†ê¸° ë•Œë¬¸ì— í•­ìƒ 0ì´ë‹¤. -> P[14]=0
- í˜„ì¬ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤(14)ë³´ë‹¤ í¬ì§€ ì•Šê¸° ë•Œë¬¸ì— ë²”ìœ„ë¥¼ ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.

## ê²°ê³¼
![Manachar's Algorithm 15]({{ site.url }}{{ site.baseurl }}/assets/img/algorithm/manachars-algorithm-15.jpg)
ë°°ì—´ Pì—ì„œ ìµœëŒ“ê°’ì„ êµ¬í•œë‹¤. i=7, i=9ì¼ ë•Œ ìµœëŒ“ê°’ P[7]=P[9]=5ê°€ ëœë‹¤. ê·¸ ìµœëŒ“ê°’ì„ ë°˜ì§€ë¦„ìœ¼ë¡œ ê°–ëŠ” palindromeì„ êµ¬í•œë‹¤. ê°ê° `ababa`, `babab`ê°€ ëœë‹¤.

# [3] êµ¬í˜„
[Leetcode 5ë²ˆ Longest Palindromic Substring](https://leetcode.com/problems/longest-palindromic-substring/)
```go
func longestPalindrome(s string) string {
	if len(s) == 1 {
		return s
	}
	S := "#" + strings.Join(strings.Split(s, ""), "#") + "#"
	P := make([]int, len(S))
	C, R := 0, 0

	for i := 1; i < len(S); i++ { // i=1ë¶€í„° ìˆœíšŒ
		if i < R { // iê°€ ê¸°ì¡´ palindrome ë²”ìœ„ì— ì•ˆì „íˆ ì¡´ì¬í•˜ë©´
			P[i] = min(R-i, P[2*C-i]) // ê¸°ì¡´ palindrome ë²”ìœ„ ë‚´ì— ì¡´ì¬í•  ê²ƒì„ ë³´ì¥í•˜ëŠ” ë¯¸ëŸ¬ë§ ì›ì†Œì˜ ê°’ì„ íƒí•œë‹¤.
		}
		for i+P[i] < len(S)-1 && i-P[i] >= 1 && // ë°°ì—´ ë°–ì„ ë²—ì–´ë‚˜ì§€ ì•Šê³ 
        S[i+P[i]+1] == S[i-1-P[i]] { // ì–‘ ì˜†ìœ¼ë¡œ expandí•´ì„œ ê°™ì€ ê°’ì„ ê°€ì§€ë©´
			P[i]++ // P[i]ì— 1ì„ ë”í•´ì¤€ë‹¤.
		}
		if i+P[i] > R { // í˜„ì¬ ië¥¼ ê¸°ì¤€ìœ¼ë¡œ í•˜ëŠ” palindromeì˜ ì˜¤ë¥¸ìª½ì´ ê¸°ì¡´ palindromeì˜ ì˜¤ë¥¸ìª½ ì¸ë±ìŠ¤ë³´ë‹¤ í¬ë©´
			C, R = i, i+P[i] // palindrome ë²”ìœ„ë¥¼ ìƒˆë¡œ ì—…ë°ì´íŠ¸ í•œë‹¤.
		}
	}

	max := 0
	maxIndex := 0
	for i, v := range P {
		if v > max {
			max = v
			maxIndex = i
		}
	}

	return s[(maxIndex-max)/2 : (maxIndex+max)/2]
}

func min(a int, b int) int {
    if a < b {
        return a
    } else {
        return b
    }
}
```

# [4] ì‹œê°„ë³µì¡ë„
ì–¼í•ë³´ë©´ nested loop ë•Œë¬¸ì— O(n^2)ì¸ ê²ƒ ê°™ì•„ ë³´ì´ì§€ë§Œ ê·¸ë ‡ì§€ ì•Šë‹¤. ê²°ë¡ ë¶€í„° ë§í•˜ìë©´ `O(N)+O(N)=O(N)`ì´ë‹¤.

ìš°ì„ , outer loopê°€ S ë°°ì—´ì„ ì°¨ë¡€ë¡œ ìˆœíšŒí•˜ëŠ”ë° S ë°°ì—´ì˜ í¬ê¸°ê°€ 2N+1ì´ê¸° ë•Œë¬¸ì— O(N)ì´ë‹¤. inner loopì—ì„œëŠ” ì–‘ìª½ì˜ ìˆ˜ê°€ ë‹¤ë¥¼ ë•Œê¹Œì§€ ì–‘ì˜†ìœ¼ë¡œ expandí•˜ëŠ”ë°, ë¯¸ëŸ¬ë§ ì›ì†Œë¥¼ í†µí•´ ì–»ì€ ê°’ìœ¼ë¡œ Së°°ì—´ì„ ì¤‘ë³µí•´ì„œ ì½ì„ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— ëª¨ë“  ì—°ì‚°ì„ ë§ˆì¹  ë•Œê¹Œì§€ ë°°ì—´ì˜ ì›ì†Œë¥¼ ë”± í•œ ë²ˆì”©ë§Œ ì½ëŠ”ë‹¤. ìœ„ì˜ ì•Œê³ ë¦¬ì¦˜ ë™ì‘ ë°©ì‹ ì´ë¯¸ì§€ë¥¼ i=1ë¶€í„° i=14ê¹Œì§€ ì­‰ í›‘ì–´ë³´ë©´ì„œ ië¥¼ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¥¸ìª½ì— ìƒˆë¡œ ì½ëŠ” ê°’(S ë°°ì—´ì˜ ë¹¨ê°„ìƒ‰)ì´ ì¤‘ë³µë˜ëŠ”ì§€ í™•ì¸í•´ë³´ë©´ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆë‹¤. i=1ì¼ ë•Œ P[2], i=2ì¼ ë•Œ P[3], P[4], i=5ì¼ ë•Œ P[6], P[7], P[8]...(ìƒëµ)

ë§¤ë²ˆ outer loopë¥¼ ìˆœíšŒí•  ë•Œë§ˆë‹¤ inner loopê°€ Në²ˆì”© ìˆœíšŒí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ **outer loopì˜ ìˆœíšŒë¥¼ ì‹œì‘í•˜ê³  ë§ˆì¹  ë•Œê¹Œì§€ inner loopì˜ ì¶•ì ëœ ì—°ì‚°ì´ ì´ O(N)**ì´ê¸° ë•Œë¬¸ì— O(N)*O(N)=O(N^2)ê°€ ì•„ë‹Œ `O(N)+O(N)=O(N)`ì´ ë˜ëŠ” ê²ƒì´ë‹¤.

# [5] ê³µê°„ë³µì¡ë„
palindromeì˜ ë°˜ì§€ë¦„ì„ ì €ì¥í•  P ë°°ì—´ì„ ì‚¬ìš©í–ˆë‹¤. ê³µê°„ë³µì¡ë„ëŠ” `O(2N+1)=O(N)`ì´ë‹¤.

# [6] ê²°ë¡ 
Manachar's ì•Œê³ ë¦¬ì¦˜ì€ palindromeì˜ ëŒ€ì¹­ì„±ì„ ì´ìš©í•˜ì—¬ ì¤‘ë³µëœ ê³„ì‚°ì„ ì¤„ì—¬ O(N) ì‹œê°„ ì•ˆì— ê°€ì¥ ê¸´ palindromeì„ ì°¾ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ë‹¤. êµ¬í˜„ëœ ì½”ë“œë¥¼ ë¨¼ì € ë³´ë©´ `R-i` í˜¹ì€ `2*C-i` ë“± ë¬´ì—‡ì„ ì˜ë¯¸í•˜ëŠ”ì§€ ì•Œê¸° ì–´ë µê¸° ë•Œë¬¸ì— ê·¸ë¦¼ìœ¼ë¡œ ì•Œê³ ë¦¬ì¦˜ì„ ë¨¼ì € ìµíˆëŠ” í¸ì´ ì´í•´í•˜ê¸° ì‰½ë‹¤. dummy ë¬¸ìë¥¼ ë¼ì›Œ ë„£ëŠ” ì´ìœ , ì§€ë¦„ì´ ì•„ë‹Œ ë°˜ì§€ë¦„ì„ ì €ì¥í•˜ëŠ” ì´ìœ  ë“± ê³µë¶€í•˜ë©´ì„œ ì˜ë¬¸ì´ ìƒê²¼ë˜ ë¶€ë¶„ë„ ê°™ì´ ì •ë¦¬í•´ë³´ì•˜ë‹¤. íŠ¹íˆ ì‹œê°„ë³µì¡ë„ë¥¼ ì´í•´í•˜ëŠ” ë° ì‹œê°„ì„ ë§ì´ ì¼ì§€ë§Œ ì´ì œëŠ” ìì‹  ìˆê²Œ O(N)ì´ë¼ê³  ë§í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.
